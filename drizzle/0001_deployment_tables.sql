-- 部署日誌表\nCREATE TABLE IF NOT EXISTS `deployment_logs` (\n  `id` varchar(36) NOT NULL DEFAULT (UUID()),\n  `deployment_id` varchar(36) NOT NULL,\n  `type` enum('BinaryMarket','CopyTradingVault') NOT NULL,\n  `status` enum('pending','processing','completed','failed') NOT NULL,\n  `contract_address` varchar(42),\n  `transaction_hash` varchar(66),\n  `block_number` int,\n  `gas_used` decimal(20,0),\n  `gas_price_final` decimal(20,0),\n  `total_cost_wei` decimal(30,0),\n  `total_cost_usd` decimal(10,2),\n  `deployment_duration` int,\n  `confirmation_time` int,\n  `confirmations` int,\n  `error_message` text,\n  `retry_count` int DEFAULT 0,\n  `parameters` text,\n  `metadata` text,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP,\n  `updated_at` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  `completed_at` timestamp,\n  PRIMARY KEY (`id`),\n  KEY `idx_deployment_id` (`deployment_id`),\n  KEY `idx_status` (`status`),\n  KEY `idx_contract_address` (`contract_address`),\n  KEY `idx_transaction_hash` (`transaction_hash`),\n  KEY `idx_created_at` (`created_at`),\n  KEY `idx_type_status` (`type`, `status`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\n\n-- 告警表\nCREATE TABLE IF NOT EXISTS `alerts` (\n  `id` varchar(36) NOT NULL DEFAULT (UUID()),\n  `title` varchar(256) NOT NULL,\n  `description` text NOT NULL,\n  `level` enum('INFO','WARNING','CRITICAL') NOT NULL,\n  `status` enum('ACTIVE','ACKNOWLEDGED','RESOLVED') NOT NULL,\n  `source` varchar(100) NOT NULL,\n  `source_id` varchar(36),\n  `category` varchar(50) NOT NULL,\n  `tags` varchar(500),\n  `priority` int DEFAULT 0,\n  `acknowledged_by` varchar(36),\n  `acknowledged_at` timestamp,\n  `resolved_by` varchar(36),\n  `resolved_at` timestamp,\n  `escalation_count` int DEFAULT 0,\n  `last_escalated_at` timestamp,\n  `notification_channels` varchar(200),\n  `metadata` text,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP,\n  `updated_at` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  PRIMARY KEY (`id`),\n  KEY `idx_level` (`level`),\n  KEY `idx_status` (`status`),\n  KEY `idx_source` (`source`),\n  KEY `idx_category` (`category`),\n  KEY `idx_created_at` (`created_at`),\n  KEY `idx_level_status` (`level`, `status`),\n  KEY `idx_source_id` (`source_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\n\n-- 審計日誌表\nCREATE TABLE IF NOT EXISTS `audit_logs` (\n  `id` varchar(36) NOT NULL DEFAULT (UUID()),\n  `user_id` varchar(36),\n  `action` varchar(100) NOT NULL,\n  `resource` varchar(100) NOT NULL,\n  `resource_id` varchar(36) NOT NULL,\n  `status` enum('success','failure') NOT NULL,\n  `status_code` int,\n  `method` varchar(10),\n  `endpoint` varchar(500),\n  `ip_address` varchar(45),\n  `user_agent` varchar(500),\n  `request_data` text,\n  `response_data` text,\n  `error_message` text,\n  `duration` int,\n  `metadata` text,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP,\n  PRIMARY KEY (`id`),\n  KEY `idx_user_id` (`user_id`),\n  KEY `idx_action` (`action`),\n  KEY `idx_resource` (`resource`),\n  KEY `idx_resource_id` (`resource_id`),\n  KEY `idx_status` (`status`),\n  KEY `idx_created_at` (`created_at`),\n  KEY `idx_action_resource` (`action`, `resource`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\n\n-- 部署統計表\nCREATE TABLE IF NOT EXISTS `deployment_stats` (\n  `id` varchar(36) NOT NULL DEFAULT (UUID()),\n  `date` timestamp NOT NULL,\n  `type` enum('BinaryMarket','CopyTradingVault','ALL') NOT NULL,\n  `total_deployments` int DEFAULT 0,\n  `successful_deployments` int DEFAULT 0,\n  `failed_deployments` int DEFAULT 0,\n  `pending_deployments` int DEFAULT 0,\n  `success_rate` decimal(5,2) DEFAULT 0,\n  `average_duration` decimal(10,2) DEFAULT 0,\n  `average_gas_used` decimal(20,0) DEFAULT 0,\n  `average_cost_usd` decimal(10,2) DEFAULT 0,\n  `min_cost_usd` decimal(10,2),\n  `max_cost_usd` decimal(10,2),\n  `total_cost_usd` decimal(15,2) DEFAULT 0,\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP,\n  `updated_at` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  PRIMARY KEY (`id`),\n  KEY `idx_date` (`date`),\n  KEY `idx_type` (`type`),\n  KEY `idx_date_type` (`date`, `type`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\n\n-- 告警統計表\nCREATE TABLE IF NOT EXISTS `alert_stats` (\n  `id` varchar(36) NOT NULL DEFAULT (UUID()),\n  `date` timestamp NOT NULL,\n  `level` enum('INFO','WARNING','CRITICAL','ALL') NOT NULL,\n  `source` varchar(100) NOT NULL,\n  `total_alerts` int DEFAULT 0,\n  `active_alerts` int DEFAULT 0,\n  `acknowledged_alerts` int DEFAULT 0,\n  `resolved_alerts` int DEFAULT 0,\n  `average_response_time` decimal(10,2) DEFAULT 0,\n  `max_response_time` decimal(10,2),\n  `min_response_time` decimal(10,2),\n  `created_at` timestamp DEFAULT CURRENT_TIMESTAMP,\n  `updated_at` timestamp DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  PRIMARY KEY (`id`),\n  KEY `idx_date` (`date`),\n  KEY `idx_level` (`level`),\n  KEY `idx_source` (`source`),\n  KEY `idx_date_level` (`date`, `level`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\n

global:\n  resolve_timeout: 5m\n  slack_api_url: '${SLACK_WEBHOOK_URL}'\n  pagerduty_url: 'https://events.pagerduty.com/v2/enqueue'\n\n# å‘Šè­¦æ¨¡æ¿\ntemplates:\n  - '/etc/alertmanager/templates/*.tmpl'\n\n# å‘Šè­¦è·¯ç”±\nroute:\n  receiver: 'default'\n  group_by: ['alertname', 'cluster', 'service']\n  group_wait: 10s\n  group_interval: 10s\n  repeat_interval: 12h\n\n  # å­è·¯ç”±\n  routes:\n    # é—œéµå‘Šè­¦ - ç«‹å³ç™¼é€\n    - match:\n        severity: critical\n      receiver: 'critical-alerts'\n      group_wait: 0s\n      repeat_interval: 1h\n      continue: true\n\n    # è­¦å‘Šå‘Šè­¦ - å»¶é²ç™¼é€\n    - match:\n        severity: warning\n      receiver: 'warning-alerts'\n      group_wait: 30s\n      repeat_interval: 4h\n\n    # éƒ¨ç½²å‘Šè­¦\n    - match:\n        service: deployment\n      receiver: 'deployment-alerts'\n      group_wait: 10s\n      repeat_interval: 2h\n\n    # Gas å‘Šè­¦\n    - match:\n        service: gas\n      receiver: 'gas-alerts'\n      group_wait: 10s\n      repeat_interval: 2h\n\n    # äº¤æ˜“å‘Šè­¦\n    - match:\n        service: transaction\n      receiver: 'transaction-alerts'\n      group_wait: 5s\n      repeat_interval: 1h\n\n    # API å‘Šè­¦\n    - match:\n        service: api\n      receiver: 'api-alerts'\n      group_wait: 10s\n      repeat_interval: 2h\n\n    # ç³»çµ±å‘Šè­¦\n    - match:\n        service: system\n      receiver: 'system-alerts'\n      group_wait: 10s\n      repeat_interval: 4h\n\n# æ¥æ”¶å™¨é…ç½®\nreceivers:\n  # é»˜èªæ¥æ”¶å™¨\n  - name: 'default'\n    slack_configs:\n      - channel: '#alerts'\n        title: '{{ .GroupLabels.alertname }}'\n        text: '{{ range .Alerts }}{{ .Annotations.description }}{{ end }}'\n        send_resolved: true\n\n  # é—œéµå‘Šè­¦æ¥æ”¶å™¨\n  - name: 'critical-alerts'\n    slack_configs:\n      - channel: '#critical-alerts'\n        title: 'ğŸš¨ {{ .GroupLabels.alertname }}'\n        text: '{{ range .Alerts }}{{ .Annotations.description }}{{ end }}'\n        send_resolved: true\n    pagerduty_configs:\n      - service_key: '${PAGERDUTY_SERVICE_KEY}'\n        description: '{{ .GroupLabels.alertname }}'\n    email_configs:\n      - to: '${ALERT_EMAIL}'\n        from: 'alerts@nexus.io'\n        smarthost: '${SMTP_SERVER}:587'\n        auth_username: '${SMTP_USER}'\n        auth_password: '${SMTP_PASSWORD}'\n        headers:\n          Subject: 'ğŸš¨ CRITICAL: {{ .GroupLabels.alertname }}'\n\n  # è­¦å‘Šå‘Šè­¦æ¥æ”¶å™¨\n  - name: 'warning-alerts'\n    slack_configs:\n      - channel: '#warnings'\n        title: 'âš ï¸ {{ .GroupLabels.alertname }}'\n        text: '{{ range .Alerts }}{{ .Annotations.description }}{{ end }}'\n        send_resolved: true\n\n  # éƒ¨ç½²å‘Šè­¦æ¥æ”¶å™¨\n  - name: 'deployment-alerts'\n    slack_configs:\n      - channel: '#deployment'\n        title: 'ğŸ“¦ {{ .GroupLabels.alertname }}'\n        text: '{{ range .Alerts }}{{ .Annotations.description }}{{ end }}'\n        send_resolved: true\n\n  # Gas å‘Šè­¦æ¥æ”¶å™¨\n  - name: 'gas-alerts'\n    slack_configs:\n      - channel: '#gas-alerts'\n        title: 'â›½ {{ .GroupLabels.alertname }}'\n        text: '{{ range .Alerts }}{{ .Annotations.description }}{{ end }}'\n        send_resolved: true\n\n  # äº¤æ˜“å‘Šè­¦æ¥æ”¶å™¨\n  - name: 'transaction-alerts'\n    slack_configs:\n      - channel: '#transactions'\n        title: 'ğŸ’± {{ .GroupLabels.alertname }}'\n        text: '{{ range .Alerts }}{{ .Annotations.description }}{{ end }}'\n        send_resolved: true\n\n  # API å‘Šè­¦æ¥æ”¶å™¨\n  - name: 'api-alerts'\n    slack_configs:\n      - channel: '#api-alerts'\n        title: 'ğŸ”Œ {{ .GroupLabels.alertname }}'\n        text: '{{ range .Alerts }}{{ .Annotations.description }}{{ end }}'\n        send_resolved: true\n\n  # ç³»çµ±å‘Šè­¦æ¥æ”¶å™¨\n  - name: 'system-alerts'\n    slack_configs:\n      - channel: '#system'\n        title: 'ğŸ–¥ï¸ {{ .GroupLabels.alertname }}'\n        text: '{{ range .Alerts }}{{ .Annotations.description }}{{ end }}'\n        send_resolved: true\n\n# å‘Šè­¦æŠ‘åˆ¶è¦å‰‡\ninhibit_rules:\n  # å¦‚æœæœ‰é—œéµå‘Šè­¦ï¼ŒæŠ‘åˆ¶è­¦å‘Šå‘Šè­¦\n  - source_match:\n      severity: 'critical'\n    target_match:\n      severity: 'warning'\n    equal: ['alertname', 'service']\n\n  # å¦‚æœæœ‰éƒ¨ç½²å¤±æ•—ï¼ŒæŠ‘åˆ¶éƒ¨ç½²æˆåŠŸç‡ä½çš„è­¦å‘Š\n  - source_match:\n      alertname: 'DeploymentFailure'\n    target_match:\n      alertname: 'LowDeploymentSuccessRate'\n    equal: ['service']\n\n  # å¦‚æœæœ‰é«˜ Gas åƒ¹æ ¼ï¼ŒæŠ‘åˆ¶é«˜ Gas æˆæœ¬çš„è­¦å‘Š\n  - source_match:\n      alertname: 'HighGasPrice'\n    target_match:\n      alertname: 'HighGasCost'\n    equal: ['service']\n
